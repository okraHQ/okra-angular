{"version":3,"file":"angular8-okra.js","sources":["ng://angular8-okra/lib/okra-token.ts","ng://angular8-okra/lib/angular8-okra.service.ts","ng://angular8-okra/lib/angular8-okra.component.ts","ng://angular8-okra/lib/angular8-okra.directive.ts","ng://angular8-okra/lib/angular8-okra.module.ts"],"sourcesContent":["import { InjectionToken } from '@angular/core';\n\nexport const PUBLIC_KEY_TOKEN = new InjectionToken<string>('okra.publickey');\n","import { Injectable, Inject } from '@angular/core';\nimport { OkraOptions } from './OkraOptions';\nimport { PUBLIC_KEY_TOKEN } from './okra-token';\n\ninterface MyWindow extends Window {\n  okra: any\n}\ndeclare var window: MyWindow;\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class Angular8OkraService {\n\n  okraPublicKey: string;\n\n  constructor(@Inject(PUBLIC_KEY_TOKEN) private token: string) {\n    this.okraPublicKey = token;   \n  }\n\n  loadScript(): Promise<void> {\n    return new Promise(resolve => {\n      if (window.okra && typeof window.okra.create === 'function') {\n        resolve();\n        return;\n      }\n\n \n      const link = window.document.createElement('link');\n      window.document.head.appendChild(link);\n      link.setAttribute('rel', 'stylesheet');\n      link.setAttribute('type', 'text/css');\n      link.setAttribute('href', 'https://cdn.okra.ng/okra.min.css');\n\n      const script = window.document.createElement('script');\n      window.document.head.appendChild(script);\n      const onLoadFunc = () => {\n        script.removeEventListener('load', onLoadFunc);\n        resolve();\n      };\n      script.addEventListener('load', onLoadFunc);\n      script.setAttribute('src', 'https://cdn.okra.ng/okra.min.js');\n    });\n  }\n\n  getOkraOptions(obj: OkraOptions): OkraOptions {\n    const okraOptions: OkraOptions = {\n      env: obj.env,\n      url_env: obj.url_env,\n      clientName: obj.clientName,\n      key: obj.key,\n      record_id: obj.record_id,\n      callback_url: obj.callback_url,\n      user: {},\n      products: obj.products,\n      onClose: obj.onClose,\n      onSuccess: obj.onSuccess\n    };\n    return okraOptions;\n  }\n}\n","import { Component, OnInit, Input, EventEmitter, Output } from '@angular/core';\nimport { OkraOptions, PrivateOkraOptions } from './OkraOptions';\nimport { Angular8OkraService } from '../public-api';\n\ninterface MyWindow extends Window {\n  okra: any\n}\ndeclare var window: MyWindow;\n\n@Component({\n  selector: 'okra-button',\n  template: `<button [ngClass]=\"customClass\" [ngStyle]=\"customStyle\" (click)=\"pay()\">Init Okra</button>`,\n})\n\nexport class Angular8OkraComponent {\n\n  @Input() env: string;\n  @Input() url_env: string;\n  @Input() clientName: number;\n  @Input() customStyle: {};\n  @Input() customClass: {};\n  @Input() record_id: string;\n  @Input() callback_url: string;\n  @Input() user: {};\n  @Input() products: string[];\n  @Input() okraOptions: OkraOptions;\n  @Output() onClose: EventEmitter<any> = new EventEmitter<any>(); // tslint:disable-line\n  @Output() onSuccess: EventEmitter<any> = new EventEmitter<any>();\n  public _okraOptions: Partial<PrivateOkraOptions>; // tslint:disable-line\n  key: string;\n\n  constructor(public okraWidgetService: Angular8OkraService) {\n    this.key = okraWidgetService.okraPublicKey;\n   }\n  async pay() {\n    this.generateOptions(this);\n    await this.okraWidgetService.loadScript();\n    const payment = new window.okra.create(this._okraOptions);\n    payment.open();\n  }\n\n  generateOptions(obj: any) {\n    this._okraOptions = this.okraWidgetService.getOkraOptions(obj);\n    this._okraOptions.onClose = () => {\n      if (this.onClose.observers.length) {\n        this.onClose.emit();\n      } \n    };\n\n    this._okraOptions.onSuccess = () => {\n      if (this.onSuccess.observers.length) {\n        this.onSuccess.emit();\n      } \n    };\n  }\n}\n","import { Directive, HostListener, Input, Output, EventEmitter } from '@angular/core';\nimport { OkraOptions, PrivateOkraOptions } from './OkraOptions';\nimport { Angular8OkraService } from '../public-api';\n\ninterface MyWindow extends Window {\n  okra: any\n}\ndeclare var window: MyWindow;\n\n@Directive({\n  selector: '[okraButton]'\n})\n\nexport class Angular8OkraDirective {\n\n  @Input() env: string;\n  @Input() url_env: string;\n  @Input() clientName: number;\n  @Input() record_id: string;\n  @Input() callback_url: string;\n  @Input() user: {};\n  @Input() products: string[];\n  @Input() okraOptions: OkraOptions;\n  @Output() onClose: EventEmitter<any> = new EventEmitter<any>(); // tslint:disable-line\n  @Output() onSuccess: EventEmitter<any> = new EventEmitter<any>();\n  public _okraOptions: Partial<PrivateOkraOptions>; // tslint:disable-line\n  key: string;\n\n  constructor(public okraWidgetService: Angular8OkraService) {\n    this.key = okraWidgetService.okraPublicKey;\n   }\n  async pay() {\n    this.generateOptions(this);\n    await this.okraWidgetService.loadScript();\n    const payment = new window.okra.create(this._okraOptions);\n    payment.open();\n  }\n\n  generateOptions(obj: any) {\n    this._okraOptions = this.okraWidgetService.getOkraOptions(obj);\n    this._okraOptions.onClose = () => {\n      if (this.onClose.observers.length) {\n        this.onClose.emit();\n      } \n    };\n\n    this._okraOptions.onSuccess = () => {\n      if (this.onSuccess.observers.length) {\n        this.onSuccess.emit();\n      } \n    };\n  }\n\n  @HostListener('click')\n  async buttonClick() {\n    this.pay();\n  }\n\n}\n","import { NgModule, ModuleWithProviders } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { Angular8OkraComponent } from './angular8-okra.component';\nimport { Angular8OkraService } from './angular8-okra.service';\nimport { PUBLIC_KEY_TOKEN } from './okra-token';\nimport { Angular8OkraDirective } from './angular8-okra.directive';\n\n\n\n@NgModule({\n  declarations: [Angular8OkraComponent, Angular8OkraDirective],\n  imports: [\n    CommonModule\n  ],\n  exports: [Angular8OkraComponent,Angular8OkraDirective],\n  providers: [],\n})\nexport class Angular8OkraModule {\n  static forRoot(token: string): ModuleWithProviders {\n    return {\n      ngModule: Angular8OkraModule,\n      providers: [\n        Angular8OkraService,\n        { provide: PUBLIC_KEY_TOKEN, useValue: token }\n      ]\n    };\n }\n}\n"],"names":["MyWindow"],"mappings":"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"}